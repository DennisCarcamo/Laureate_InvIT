<br>
<div class="container" *ngIf="privilege">
    
    <div>
        <h3>Roles-Privileges Admin <span><i class="fa fa-lock" aria-hidden="true"></i></span></h3>
        <p>"Users, roles and permissions are key components of website security, and they're of major importance in Drupal as well. Users are the people, roles are their functions, and permissions define what authorizations those functions have. Setting these up incorrectly can compromise your website's security."</p>
        <br>
        <div class="form-group"> 
            <button class="btn btn-info btn-sm" (click)="start()">Assign Role to User</button>
            <button class="btn btn-info btn-sm" (click)="createRole()">Create Role!</button>
            <button class="btn btn-info btn-sm" (click)="deleteRole()">Delete User Privilleges</button>
            
        </div>
    </div>
    
    <ul class="list-group" *ngFor="let item of selectemploye">
        <li class="list-group-item list-group-item-success ">{{item.FIRST_NAME}}  {{item.LAST_NAME}} - {{item.EMAIL}}</li>
        
    </ul>
    
    <div *ngIf="boolemployee">
        <h3>Select the employee</h3>
        <app-employee-table (employeevent)="selectemploye=$event"></app-employee-table>
        <div class="d-flex justify-content-center">
            <button class="btn btn-info btn-sm" (click)="backemployee()">Go Back</button><h4>-</h4>
            <button class="btn btn-info btn-sm" (click)="continueroles()">Continue</button>
        </div>
        
        
    </div>
    <br>
    
    <div class="" *ngIf="boolDelete">
        <div>
            <h3>Remove Privileges <span style="color:red"><i class="fa fa-times" aria-hidden="true"></i></span></h3>
            <br>
            <ul class="list-group" *ngFor="let item of selectedUser">
                <li class="list-group-item list-group-item-success ">User : {{item.ROLE}} - {{item.USER_NAME}} - {{item.ID}}</li>
                  
            </ul>
            <br>
            <table class="table">
                    <thead class="thead-dark">
                      <tr class="">
                        <th scope="col">User ID</th>
                        <th scope="col">User Name</th>
                        <th scope="col">Role</th>
                        <th scope="col">select</th>
                       <!-- <th scope="col">Status</th>
                        <th scope="col">Last?</th> -->
                        
                      </tr>
                    </thead>
                    <tbody *ngFor="let product of users2">
                  
                      <tr class="select">
                        <th scope="row">{{product.id}}</th>
                        <td>{{product.name}}</td>
                        <td>{{product.rol}}</td>
                        <td><button class="btn btn-danger btn-sm" (click)="onSelect(product)" >select</button></td>
                      </tr>
                  
                    </tbody>
                  
            </table>

        </div>
        <br>
            <div class="d-flex justify-content-center">
                <button class="btn btn-info" (click)="removeUser(DeleteUser)">Remove</button>

            </div>
    </div>

  <div *ngIf="boolassign">
    <h3 *ngFor="let item of selectemploye"> Select a role for {{item.FIRST_NAME}}  {{item.LAST_NAME}}</h3>
    <div >
      <select  class="form-control" [(ngModel)]="option">
        <option></option>
        <option *ngFor="let item of roles" [value]="item.id_role" >{{item.id_role}} - {{item.role_name}}</option>
  
      </select>

    </div>
    <br><br>
    <div class="d-flex justify-content-center">
        <button class="btn btn-primary btn-lg" (click)="openModal(template)">Assign Role</button>
    </div>
  </div>



  <div class="" *ngIf="boolroles">
      <h3>New Role name <span><i class="fa fa-refresh" aria-hidden="true"></i></span></h3>
    <div class="d-flex justify-content-center">
        <div class="col-sm-12">
            <input type="text" class="form-control" maxlength="25" [(ngModel)]="newRoleName">

        </div>

    </div><br>

    <div class="">
        <h3>Drag & Drop Privileges <span><i class="fa fa-hand-paper-o" aria-hidden="true"></i></span></h3>

       <div class="row">
        <div class="d-flex justify-content-conter">

                <div class="col-sm-12">
                    <div class="card card-outline-success mb-3">
                        <div class="card-header card-inverse card-success">
                            Privileges
                            </div>
                        <div class="card-block scroll-list">
                            <div class="list-group">
                                <li class="list-group-item list-group-item-action list-group-item-success" [draggable] *ngFor="let item of vegetables"
                                    [dragClass]="'active'" [dragData]="item" [dragScope]="item.type" [dragEnabled]="dragEnabled">
                                    {{item.name}}
                                </li>
                            </div>
                        </div>
            
                    </div>
            
                </div>
            
                <div class="col-sm-12">
                    <div class="card card-outline-primary mb-3" droppable [dragOverClass]="'drag-target-border'" [dropScope]="['fruit', 'vegetable']"
                        [dragHintClass]="'drag-hint'" (onDrop)="onAnyDrop($event)">
                        <div class="card-header card-inverse card-primary">Selected Privileges</div>
                        <div class="card-block scroll-list">
                            <li *ngFor="let item of droppedItems" class="list-group-item">{{item.name}}</li>
                        </div>
                    </div>
                </div>
            
             <!-- kkkik!-->
        </div>    

        
    </div>
    <br>
    <div class="d-flex justify-content-center">
        <button class="btn btn-primary btn-lg" (click)="openRoleModal(templateRole)">Create Role</button> 
    </div>
    </div>

    
    <!--  <button class="btn btn-danger" (click)="test()">Test</button> -->
    
    
</div>

<ng-template #template>
    <div class="modal-body text-center alert ">
        <p>Are you sure to assign this role to this person? <span><i class="fa fa-question-circle-o" aria-hidden="true"></i></span></p>

        <div class="modal-body alert alert-warning" role="alert">
            The following permits will be assigned press 'YES', to continue or 'No', to go back.
        </div>
        <div >
            <ul class="list-group" *ngFor="let item of privilegesxrol">
                <li class="list-group-item list-group-item-primary ">{{item.privilege}} </li>
                  
            </ul>
        </div><br>
        <button type="button" class="btn btn-primary" (click)="confirm()" >Yes</button>
        <button type="button" class="btn btn-danger" (click)="abort()" >No</button>
    </div>

   
</ng-template>

<ng-template #templateRole>
    <div class="modal-body text-center alert alert-info ">
        <p>Are you sure of creating this new role? <span><i class="fa fa-question-circle-o" aria-hidden="true"></i></span></p>
        <button type="button" class="btn btn-primary" (click)="confirmRolePrivileges()" >Yes</button>
        <button type="button" class="btn btn-danger" (click)="abort()" >No</button>
    </div>

   
</ng-template>

<ng-template #DeleteUser>
        <div class="modal-body text-center alert alert-warning ">
            <b><p *ngFor="let item of selectedUser">Delete privileges to {{item.USER_NAME}} <span style="color:red"><i class="fa fa-times" aria-hidden="true"></i></span> </p></b>
             <br>
             <p>The privileges will be removed and the user will not be able to enter the system anymore. Are you sure to continue?</p>   
            <button type="button" class="btn btn-primary" (click)="confirmDeleteUser()" >Yes</button>
            <button type="button" class="btn btn-danger" (click)="abort()" >No</button>
        </div>
    
       
    </ng-template>